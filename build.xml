<?xml version="1.0"?> 
<project name="de.learn2prog.struktor" default="compile" basedir="."> 

     <property name="src" value="src"/> 
     <property name="build" value="build"/>
	 <property name="procParser" value="ProcParserFactory/procParser.cup"/>

     <target name="init">  
          <mkdir dir="${build}"/>
     </target>

     <target name="compile" depends="init"> 
          <!-- Compile the java code -->
          
          <javac srcdir="${src}" destdir="${build}"/>
     </target>
	<target name="Clean" description="Removes previous build">
	  <delete verbose="true">
	    <fileset dir="${build}"/>
	  </delete>
	</target>
	<target name="ProcParser" depends="init" description="Builds the ProcParser"> 
		<java dir="ProcParserFactory" fork="true" jar="lib/java-cup-11a.jar">
		   <arg line="-parser ProcParser -symbols Psym procParser.cup"/>
        </java>
		<copy file="ProcParserFactory/Psym.java" tofile="struktor/processor"/>
		<copy file="ProcParserFactory/ProcParser.java" tofile="struktor/processor"/>
	</target>
	<target name="LoadParser" depends="init" description="Builds the LoadParser"> 
		<java dir="LoadParserFactory" fork="true" jar="lib/java-cup-11a.jar">
		   <arg line="-parser LoadParser -symbols Lsym loadParser.cup"/>
        </java>
		<copy file="LoadParserFactory/Lsym.java" tofile="struktor/strukelements"/>
		<copy file="LoadParserFactory/LoadParser.java" tofile="struktor/strukelements"/>
	</target>
	<target name="jar" depends="compile">
		<jar destfile="struktor.jar" basedir="${build}">
		</jar>
	</target>
	<target name="runApplet" depends="jar">
	     <exec dir="." executable="appletviewer">
	       <arg value="struktor.html" />
	     </exec>
	</target>
</project>