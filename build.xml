<?xml version="1.0"?> 
<project name="de.learn2prog.struktor" default="compile" basedir="."> 
    
	<taskdef name="cup" classname="java_cup.anttask.CUPTask" classpath="lib/java-cup-11a.jar"/>

     <property name="src" value="src" location="src"/> 
     <property name="build" value="build"/>

     <target name="init">  
          <mkdir dir="${build}"/>
     </target>

     <target name="compile" depends="init"> 
          <!-- Compile the java code -->
          
          <javac srcdir="${src}" destdir="${build}"/>
     </target>
	<target name="Clean" description="Removes previous build">
	  <delete verbose="true">
	    <fileset dir="${build}"/>
	  </delete>
	</target>
	<target name="ProcLexer" depends="init" description="Builds the ProcLexer"> 
		<java dir="ProcLexerFactory" fork="true" jar="lib/JFlex.jar">
		   <arg line="processor.lex"/>
        </java>
		<copy file="ProcLexerFactory/Yylex.java" tofile="${src}/struktor/processor/Yylex.java"/>
	</target>
	<target name="LoadLexer" depends="init" description="Builds the LoadLexer"> 
		<java dir="LoadLexerFactory" fork="true" jar="lib/JFlex.jar">
		   <arg line="loader.lex"/>
        </java>
		<copy file="LoadLexerFactory/Yylex.java" tofile="${src}/struktor/strukelements/Yylex.java"/>
	</target>
	<target name="ParserBuild" depends="init" description="Builds the LoadParser"> 
		<cup srcfile="LoadParserFactory/loadParser.cup" 
			parser="LoadParser" 
			symbols = "Lsym"
			destdir="${src}"
		/>
		<cup srcfile="ProcParserFactory/procParser.cup" 
			parser="ProcParser" 
			symbols = "Psym"
			destdir="${src}"
		/>
	</target>
	<target name="jar" depends="compile">
		<jar destfile="struktor.jar" basedir="${build}">
		</jar>
	</target>
	<target name="runApplet" depends="jar">
	     <exec dir="." executable="appletviewer">
	       <arg value="struktor.html" />
	     </exec>
	</target>
</project>